<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>YÃ¶netim Paneli</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .navbar-logo {
            height: 30px; 
            margin-right: 10px;
        }
        /* Ä°statistik sayÄ±larÄ±nÄ± biraz kÃ¼Ã§Ã¼lttÃ¼k */
        .stat-value {
            font-size: 2.8rem;
            font-weight: 700;
        }
    </style>
</head>
<body>

<nav class="navbar navbar-dark bg-primary mb-4">
    <div class="container">
        <a class="navbar-brand" href="/dashboard">
            <img src="/static/logogumushane.png" alt="GÃ¼mÃ¼ÅŸhane Ãœniversitesi Logo" class="navbar-logo">
            Torul MYO Hastanesi
        </a>
        <a href="/" class="btn btn-light btn-sm">Ã‡Ä±kÄ±ÅŸ</a>
    </div>
</nav>

<div class="container">
    <h3 class="mb-4">Ä°statistikler</h3>

    <div class="row text-center g-3">
        
        <div class="col-md-3 mb-3">
            <div class="card p-4 h-100 shadow-sm border-success">
                <h3 class="stat-value text-success">{{ toplam_hasta }}</h3>
                <p class="lead mb-0">Toplam KayÄ±tlÄ± Hasta</p>
            </div>
        </div>

        <div class="col-md-3 mb-3">
            <div class="card p-4 h-100 shadow-sm border-info">
                <h3 class="stat-value text-info">{{ toplam_randevu }}</h3>
                <p class="lead mb-0">Toplam Randevu SayÄ±sÄ±</p>
            </div>
        </div>
        
        <div class="col-md-3 mb-3">
            <div class="card p-4 h-100 shadow-sm border-warning">
                <h3 class="stat-value text-warning">{{ bugun_randevu }}</h3>
                <p class="lead mb-0">BugÃ¼nkÃ¼ Randevu SayÄ±sÄ±</p>
            </div>
        </div>

        <div class="col-md-3 mb-3">
            <div class="card p-4 h-100 shadow-sm border-primary">
                <h3 class="stat-value text-primary">â•</h3>
                <p class="lead mb-0">Yeni Hasta KaydÄ±</p>
                <a href="/add_patient" class="btn btn-primary mt-3">Ekle</a>
            </div>
        </div>
    </div>
    
    <hr class="mt-4 mb-4">

    <div class="row mb-5">
        <div class="col-lg-7 col-md-8 mx-auto">
            <div class="card shadow">
                <div class="card-header bg-light">
                    RandevularÄ±n Doktora GÃ¶re DaÄŸÄ±lÄ±mÄ±
                </div>
                <div class="card-body" style="height: 350px;"> 
                    <canvas id="doctorPieChart"></canvas> 
                </div>
            </div>
        </div>
    </div>
    
    <hr class="mt-4 mb-4">
    
    <h3 class="mb-4">HÄ±zlÄ± EriÅŸim MenÃ¼sÃ¼</h3>
    
    <div class="row text-center g-3">
        
        <div class="col-md-4 mb-3">
            <div class="card p-4 h-100 shadow-sm">
                <h3 class="text-success">ğŸ“‹ Hasta Listesi</h3>
                <p>KayÄ±tlÄ± hastalarÄ± gÃ¶rÃ¼ntÃ¼le ve ara.</p>
                <a href="/patients" class="btn btn-outline-success mt-auto">Git</a>
            </div>
        </div>
        
        <div class="col-md-4 mb-3">
            <div class="card p-4 h-100 shadow-sm">
                <h3 class="text-warning">ğŸ“… Randevu Al</h3>
                <p>Poliklinik randevusu oluÅŸtur.</p>
                <a href="/appointment" class="btn btn-outline-warning mt-auto">Git</a>
            </div>
        </div>
        
        <div class="col-md-4 mb-3">
            <div class="card p-4 h-100 shadow-sm">
                <h3 class="text-info">ğŸ“… Randevu Takip</h3>
                <p>Muayene ve reÃ§ete iÅŸlemlerini yÃ¶net.</p>
                <a href="/appointment_list" class="btn btn-outline-info mt-auto">Listele</a>
            </div>
        </div>
    </div>
</div>

<script>
    const labels = JSON.parse('{{ chart_labels | safe }}');
    const counts = JSON.parse('{{ chart_counts | safe }}');

    const backgroundColors = [
        'rgba(255, 99, 132, 0.8)',
        'rgba(54, 162, 235, 0.8)',
        'rgba(255, 206, 86, 0.8)',
        'rgba(75, 192, 192, 0.8)',
        'rgba(153, 102, 255, 0.8)',
        'rgba(255, 159, 64, 0.8)'
    ];

    const ctx = document.getElementById('doctorPieChart').getContext('2d');
    
    new Chart(ctx, {
        type: 'pie',
        data: {
            labels: labels,
            datasets: [{
                label: 'Randevu SayÄ±sÄ±',
                data: counts,
                backgroundColor: backgroundColors.slice(0, counts.length),
                borderColor: '#fff',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false, 
            plugins: {
                legend: {
                    position: 'right', // Legend'Ä± saÄŸa aldÄ±k
                },
                title: {
                    display: true,
                    text: 'Randevu YoÄŸunluÄŸu'
                }
            }
        }
    });
</script>

</body>
</html>